<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <h1>Welcome to find Skill fast</h1>
    <form>
        <p>
            Username: <input type="text" id="username">
        </p>
        <p>
            Password: <input type="text" id="password">
        </p>
        <p>
            Skill:
            <select id="skill">
                <option value='engineer'>Engineer</option>
                <option value='phone repair'>Phone Repair</option>
                <option value='tailor'>Tailor</option>
                <option value='doctor'>Doctor</option>
                <option value='Mechanic'>Mechanic</option>
                <option value='Data scientist'>Data Scientist</option>
                <option value='software developer'>Developer</option>
                <option value='Mason man'>Mason man</option>
            </select>
        </p>

        <button>Sign Up</button>
    </form>
    <a href="./signin.html">Already have an account? sign in</a>
    <script>
        let form = document.querySelector("form")

        form.addEventListener("submit", addUser)

        function addUser(e){
            e.preventDefault()
            let username = document.querySelector("#username").value
            let password = document.querySelector("#password").value
            let skill = document.querySelector("#skill").value
            
            if(username.length < 2){
                alert("Invalid username. Please change")
                return 
            }
            createProfile(username, password, skill)

        }

        function createProfile(username, password, skill){
            if(!localStorage.getItem("users")){
                localStorage.setItem('users', JSON.stringify({}))
            }
            // {
            //     sam : {
            //         password: 12345,
            //         skill : tailor,
            //         friends: [mitchel, andikan]
            //     },
            //     vic:{
            //         password: 12345,
            //         skill : tailor,
            //         friends: [mitchel, andikan]
            //     }
            // }

            const users = JSON.parse(localStorage.getItem("users"))
            if(users.hasOwnProperty(username)){
                alert("user already exist")
                return
            }
            let userprofile = {
                password : password,
                skill: skill,
                friends : []
            }
            users[username] = userprofile
            console.log(users)
            localStorage.setItem("users", JSON.stringify(users))
            alert("User succesfully created")

            // Take user to sign in page
            window.location.href = './signin.html'
        }
    </script>
</body>
</html>